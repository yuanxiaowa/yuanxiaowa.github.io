(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["video-index"],{"007b":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("search-wrap",{attrs:{"default-type":"tencent",types:t.types,"search-handler":t.searchHandler},on:{play:t.toPlay},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.item;return[r.desc?n("div",{staticClass:"grey--text"},[t._v(t._s(r.desc))]):t._e(),r.series?n("div",{class:r.collapsed?"video-list-collapsed":""},t._l(r.series,function(e,r){return n("v-btn",{key:r,attrs:{small:"",to:t.getRouteArg({url:e.url,type:t.type})}},[t._v(t._s(e.name))])}),1):t._e(),r.series?n("div",[n("v-btn",{attrs:{icon:""},on:{click:function(t){r.collapsed=!r.collapsed}}},[t._v(t._s(r.collapsed?"展开":"收缩"))])],1):t._e()]}}])},[n("div",{attrs:{slot:"other"},slot:"other"},t._l(t.recommends,function(e,r){return n("div",{key:r},["string"===typeof e?n("div",{staticClass:"pa-2"},[n("div",{staticClass:"headline orange--text"},[t._v("\n          "+t._s(e)+"\n        ")])]):n("v-card",{staticClass:"my-2"},[n("v-layout",[n("div",[n("v-img",{attrs:{src:e.cover,"lazy-src":"https://img.imjad.cn/images/2019/02/15/330720-140F40QG761.jpg",width:"200","aspect-ratio":1.3}})],1),n("v-flex",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[e.title?n("div",{staticClass:"headline"},[t._v(t._s(e.title))]):t._e(),e.desc?n("div",{staticClass:"grey--text"},[t._v(t._s(e.desc))]):t._e()])]),n("v-card-actions",[n("v-btn",{attrs:{color:"primary",to:{name:"video-player",query:{url:e.url,direct:!0,video_only:!0}}}},[n("v-icon",[t._v("play_circle_filled")])],1)],1)],1)],1)],1)],1)}),0)])},a=[],i=n("a34a"),s=n.n(i),c=n("6eec"),o=n("3040"),u=n("c665"),l=n("dc0a"),p=n("aa9a"),d=n("d328"),v=n("11d9"),f=n("9ab4"),h=n("60a3"),y=n("9530"),b=n.n(y),m=n("df56"),_=n("cdf7");function g(){var t=Object(c["a"])(["\n        query {\n          videoSites {\n            id\n            text\n            value\n            direct\n          }\n        }\n      "]);return g=function(){return t},t}var w=function(t){function e(){var t;return Object(u["a"])(this,e),t=Object(d["a"])(this,Object(v["a"])(e).apply(this,arguments)),t.types=[],t.recommends=[],t}return Object(p["a"])(e,[{key:"created",value:function(){var t=Object(o["a"])(s.a.mark(function t(){var e,n,r=this;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return Object(_["b"])(this.type).then(function(t){r.recommends=t}),t.next=3,this.$apollo.query({query:b()(g())});case 3:e=t.sent,n=e.data.videoSites,this.types=n.map(function(t){return{text:t.text,value:t.id,direct:t.direct}});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"searchHandler",value:function(t){return Object(_["a"])(this.type).search(t)}},{key:"getRouteArg",value:function(t){var e=this,n=this.types.find(function(t){return t.value===e.type});return{name:"video-player",query:{url:t.url,direct:n.direct?"true":void 0}}}},{key:"toPlay",value:function(t){this.$router.push(this.getRouteArg(t))}},{key:"type",get:function(){return this.$route.query.type}}]),Object(l["a"])(e,t),e}(h["d"]);w=f["a"]([Object(h["a"])({components:{SearchWrap:m["a"]}})],w);var k=w,x=k,j=(n("fb57"),n("2877")),O=Object(j["a"])(x,r,a,!1,null,null,null);O.options.__file="index.vue";e["default"]=O.exports},"2b80":function(t,e,n){},"7d65":function(t,e,n){},cdf7:function(t,e,n){"use strict";n.d(e,"a",function(){return y}),n.d(e,"c",function(){return b}),n.d(e,"b",function(){return m});var r=n("a34a"),a=n.n(r),i=n("6eec"),s=n("3040"),c=n("bc3a"),o=n.n(c),u=n("9530"),l=n.n(u),p=n("53b8");function d(){var t=Object(i["a"])(["query ($url: String!) {\n        video(url:$url) {\n          title\n          type\n          cover\n          url\n          desc\n          rate\n          series\n          nodirect\n        }\n      }"]);return d=function(){return t},t}function v(){var t=Object(i["a"])(["query ($kw: String!,$type:String!, $page:Int) {\n        videoSearch(kw:$kw, type:$type,page:$page) {\n          page\n          pages\n          items\n        }\n      }"]);return v=function(){return t},t}var f={search:function(){var t=Object(s["a"])(a.a.mark(function t(e){var n,r;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].query({query:l()(v()),variables:e});case 2:return n=t.sent,r=n.data.videoSearch,t.abrupt("return",r);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),info:function(){var t=Object(s["a"])(a.a.mark(function t(e){var n,r;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].query({query:l()(d()),variables:e});case 2:return n=t.sent,r=n.data.video,t.abrupt("return",r);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},h={search:function(){var t=Object(s["a"])(a.a.mark(function t(e){var n,r,i,s,c;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.a.get("https://api.imjad.cn/bilibili/v2/",{params:{get:"search",keyword:e.kw}});case 2:if(n=t.sent,r=n.data,i=r.code,s=r.data,c=r.message,0===i){t.next=9;break}throw new Error(c);case 9:return t.abrupt("return",{page:s.page,pages:-1,items:s.items.archive.map(function(t){return t.url="https://www.bilibili.com/video/".concat(t.goto).concat(t.param),t})});case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),info:function(){var t=Object(s["a"])(a.a.mark(function t(e){return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:throw new Error("暂无数据");case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()};function y(t){return"bilibili"===t?h:f}function b(t){return t.startsWith("https://www.bilibili.com")?h:f}function m(t){return _.apply(this,arguments)}function _(){return _=Object(s["a"])(a.a.mark(function t(e){var n,r;return a.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.a.get("https://api.apiopen.top/todayVideo");case 2:return n=t.sent,r=n.data,t.abrupt("return",r.result.map(function(t){var e=t.data;return"textCard"===t.type?e.text:(e=e.content.data,{title:e.title,cover:e.cover.detail,desc:e.description,url:e.playUrl})}));case 5:case"end":return t.stop()}},t,this)})),_.apply(this,arguments)}},cf5c:function(t,e,n){"use strict";var r=n("7d65"),a=n.n(r);a.a},df56:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-layout",[n("div",[n("v-autocomplete",{attrs:{items:t.types,placeholder:"来源"},on:{change:t.onTypeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),n("v-text-field",{attrs:{placeholder:"请输入关键字","append-icon":"search",loading:t.loading,autofocus:""},on:{"click:append":function(e){t.onSearch(!0)},keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.onSearch(!0)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t.loading?n("div",{staticClass:"text-xs-center"},[n("v-progress-circular",{attrs:{size:70,width:7,color:"purple",indeterminate:""}})],1):t.keyword?t.error_text?n("div",{staticClass:"text-xs-center grey--text"},[t._v("\n    "+t._s(t.error_text)+"\n    "),n("v-btn",{attrs:{small:"",color:"error",flat:""},on:{click:t.search}},[t._v("重试")])],1):n("div",[n("v-layout",[n("v-flex",[t._v("\n        搜索结果 "+t._s(0===t.contents.length?"无":"")+"\n      ")]),n("v-btn",{attrs:{icon:"",title:"刷新"},on:{click:t.search}},[n("v-icon",[t._v("refresh")])],1)],1),n("v-layout",{attrs:{wrap:""}},[n("v-slide-y-transition",{staticStyle:{display:"block",width:"100%"},attrs:{group:""}},t._l(t.contents,function(e,r){return n("v-flex",{key:r,staticClass:"my-1",attrs:{xs12:""}},[n("v-card",{attrs:{flat:""}},[n("v-layout",[n("div",[n("v-img",{attrs:{src:e.cover,"lazy-src":"https://img.imjad.cn/images/2019/02/15/330720-140F40QG761.jpg",width:"200","aspect-ratio":1.3}},[e.type?n("span",{staticClass:"blue white--text px-1"},[t._v("\n                    "+t._s(e.type)+"\n                  ")]):t._e()])],1),n("v-flex",[n("v-card-title",{attrs:{"primary-title":""}},[n("div",[n("div",{staticClass:"headline"},[t._v(t._s(e.title))]),t._t("default",null,{item:e})],2)]),n("v-card-actions",[n("v-btn",{attrs:{color:"primary"},on:{click:function(n){t.play(e)}}},[n("v-icon",[t._v("play_circle_filled")])],1),t._t("actions",null,{item:e})],2)],1)],1)],1)],1)}),1)],1),n("div",{staticClass:"text-xs-center"},[t.total_page>0?n("v-pagination",{attrs:{length:t.total_page},on:{input:function(e){t.onSearch(!1)}},model:{value:t.offset,callback:function(e){t.offset=e},expression:"offset"}}):t.total_page<0?n("div",[n("v-btn",{attrs:{disabled:t.offset<=1},on:{click:function(e){t.toPage(t.offset-1)}}},[t._v("上一页")]),n("v-btn",{on:{click:function(e){t.toPage(t.offset+1)}}},[t._v("下一页")])],1):t._e()],1)],1):t._t("other")],2)},a=[],i=n("a34a"),s=n.n(i),c=n("3040"),o=n("c665"),u=n("dc0a"),l=n("aa9a"),p=n("d328"),d=n("11d9"),v=n("9ab4"),f=n("60a3"),h=function(t){function e(){var t;return Object(o["a"])(this,e),t=Object(p["a"])(this,Object(d["a"])(e).apply(this,arguments)),t.contents=[],t.keyword="",t.type="",t.offset=1,t.limit=20,t.loading=!1,t.total_page=0,t.error_text="",t}return Object(l["a"])(e,[{key:"beforeRouteUpdate",value:function(){this.syncParams(),this.keyword&&this.search()}},{key:"syncParams",value:function(){var t=this.$route.query;this.keyword=t.keyword,this.limit=Number(t.limit)||20,this.offset=Number(t.offset)||1,this.type=t.type||this.defaultType}},{key:"onTypeChange",value:function(){this.keyword&&this.onSearch(!0)}},{key:"onSearch",value:function(t){t&&(this.offset=1),this.$router.push({name:this.$route.name,query:{keyword:this.keyword,offset:String(this.offset),limit:String(this.limit),type:this.type}})}},{key:"search",value:function(){var t=Object(c["a"])(s.a.mark(function t(){var e,n,r;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,this.contents=[],t.prev=2,t.next=5,this.searchHandler({kw:this.keyword,page:this.offset-1,type:this.type});case 5:e=t.sent,n=e.pages,r=e.items,this.total_page=n,this.contents=r.map(function(t){return t.collapsed=!0,t}),this.error_text="",t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](2),this.error_text=t.t0.message;case 16:this.loading=!1;case 17:case"end":return t.stop()}},t,this,[[2,13]])}));return function(){return t.apply(this,arguments)}}()},{key:"play",value:function(t){}},{key:"toPage",value:function(t){this.offset=t,this.onSearch(!1)}}]),Object(u["a"])(e,t),e}(f["d"]);v["a"]([Object(f["c"])()],h.prototype,"types",void 0),v["a"]([Object(f["c"])(Function)],h.prototype,"searchHandler",void 0),v["a"]([Object(f["c"])()],h.prototype,"defaultType",void 0),v["a"]([Object(f["e"])("$route",{immediate:!0})],h.prototype,"beforeRouteUpdate",null),v["a"]([Object(f["b"])()],h.prototype,"play",null),h=v["a"]([Object(f["a"])({})],h);var y=h,b=y,m=(n("cf5c"),n("2877")),_=Object(m["a"])(b,r,a,!1,null,null,null);_.options.__file="SearchWrap.vue";e["a"]=_.exports},fb57:function(t,e,n){"use strict";var r=n("2b80"),a=n.n(r);a.a}}]);