(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["svn-id"],{1921:function(t,e,n){},"22a8":function(t,e,n){},2942:function(t,e,n){},4648:function(t,e,n){"use strict";var a=n("22a8"),r=n.n(a);r.a},"734d":function(t,e,n){},"8f2e":function(t,e,n){"use strict";var a=n("2942"),r=n.n(a);r.a},"9db4":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-layout",{staticClass:"pa-3"},[n("v-flex",[t._v("\n      "+t._s(t.path)+"\n    ")]),n("v-btn",{attrs:{small:"",color:"primary"},on:{click:function(e){t.showLog(t.path,!1)}}},[t._v("查看日志")])],1),n("v-tabs",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("v-tab",{attrs:{href:"#tab-1"}},[t._v("本地")]),n("v-tab",{attrs:{href:"#tab-2"}},[t._v("合并")])],1),n("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("v-tab-item",{attrs:{value:"tab-1"}},[n("svn-local",{ref:"sl",attrs:{path:t.path},on:{"show-log":t.showLog,message:t.onMessage}})],1),n("v-tab-item",{attrs:{value:"tab-2"}},[n("keep-alive",["tab-2"===t.tab?n("svn-merge",{attrs:{path:t.path,url:t.url},on:{message:t.onMessage,merged:t.onMerged}}):t._e()],1)],1)],1),n("v-expansion-panel",{staticClass:"mt-3"},[n("v-expansion-panel-content",[n("div",{attrs:{slot:"header"},slot:"header"},[t._v("日志")]),n("v-card",{attrs:{dark:""}},[t.logs.length>0?n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{flat:"",icon:"",color:"red"},on:{click:t.clearLogs}},[n("v-icon",[t._v("cancel")])],1)],1):t._e(),0===t.logs.length?n("v-card-title",[t._v("暂无记录")]):t._e(),t._l(t.logs,function(e,a){return n("v-card-text",{key:a},[n("v-layout",[n("v-flex",t._l(e.items,function(e,a){return n("div",{key:a},[t._v("\n                "+t._s(e)+"\n              ")])}),0),n("div",[t._v("\n              "+t._s(t._f("date")(e.date))+"\n            ")])],1),n("v-divider")],1)})],2)],1)],1),n("my-dialog",{attrs:{"max-width":"800px",title:"修改记录"},model:{value:t.show_log,callback:function(e){t.show_log=e},expression:"show_log"}},[n("div",[t._v("文件路径："+t._s(t.log_path))]),n("svn-log",{attrs:{path:t.log_path,"remote-base":t.log_remote_base}})],1)],1)},r=[],i=n("a34a"),s=n.n(i),o=n("6eec"),c=n("3040"),l=n("c665"),u=n("dc0a"),h=n("aa9a"),v=n("d328"),p=n("11d9"),d=n("9ab4"),f=n("60a3"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",[n("v-card-actions",[n("v-spacer"),n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",icon:""},on:{click:t.update},slot:"activator"},[n("v-icon",[t._v("arrow_downward")])],1),n("span",[t._v("更新")])],1),n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",icon:""},on:{click:t.refresh},slot:"activator"},[n("v-icon",[t._v("refresh")])],1),n("span",[t._v("刷新")])],1)],1),n("v-card-text",[n("v-data-table",{attrs:{headers:t.headers,items:t.items,"select-all":"primary",loading:t.loading,"item-key":"path",pagination:t.pagination},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[n("td",[n("v-checkbox",{attrs:{primary:"","hide-details":"",color:"primary"},model:{value:e.selected,callback:function(n){t.$set(e,"selected",n)},expression:"props.selected"}})],1),n("td",["added"!==e.item.type&&"unversioned"!==e.item.type?n("a",{attrs:{color:"primary"},on:{click:function(n){t.$emit("show-log",e.item.path)}}},[t._v("\n              "+t._s(e.item.path)+"\n            ")]):n("div",[t._v(t._s(e.item.path))])]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.type))]),n("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.revision))]),n("td",[e.item.commit?n("div",[t._v("\n              提交者："+t._s(e.item.commit.author)+" "),n("br"),t._v(" 时间："+t._s(t._f("date")(e.item.commit.date))+"\n              "),n("br"),t._v(" 版本："+t._s(e.item.commit.revision)+"\n            ")]):t._e()]),n("td",{staticClass:"text-xs-right"},[n("v-icon",{attrs:{disabled:!("unversioned"!==e.item.type&&!e.item.hasConflict),color:"green"},on:{click:function(n){t.commit([e.item.path])}}},[t._v("arrow_upward")]),n("v-icon",{attrs:{disabled:"unversioned"!==e.item.type,color:"green"},on:{click:function(n){t.add([e.item.path])}}},[t._v("add")]),n("v-icon",{attrs:{disabled:!e.item.hasConflict,color:"warn"},on:{click:function(n){t.resolve([e.item.path])}}},[t._v("check")]),n("v-icon",{attrs:{disabled:"added"===e.item.type||"unversioned"===e.item.type,color:"red"},on:{click:function(n){t.del([e.item.path])}}},[t._v("delete")])],1)]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[n("v-layout",{attrs:{slot:"actions-prepend","align-center":""},slot:"actions-prepend"},[n("v-text-field",{attrs:{placeholder:"注释"},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),t.has_new?n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",icon:"",flat:"",small:"",color:"green"},on:{click:t.addSelected},slot:"activator"},[n("v-icon",[t._v("add")])],1),n("span",[t._v("添加选中")])],1):t._e(),n("v-tooltip",{attrs:{top:""}},[n("v-btn",{attrs:{slot:"activator",icon:"",flat:"",small:"",color:"green"},on:{click:t.commitSelected},slot:"activator"},[n("v-icon",[t._v("arrow_upward")])],1),n("span",[t._v("提交选中")])],1)],1)],1)],1)],1)],1)},g=[],b=n("9530"),y=n.n(b);function _(){var t=Object(o["a"])(["query($path:String!) {\n        svnStatus(cwd: $path) {\n          path\n          type\n          revision\n          hasConflict\n          commit {\n            author\n            date\n            revision\n          }\n        }\n      }"]);return _=function(){return t},t}function k(){var t=Object(o["a"])(["mutation($paths:[String]!, $cwd:String){\n        svnDel(paths:$paths, cwd:$cwd)\n      }"]);return k=function(){return t},t}function w(){var t=Object(o["a"])(["mutation($paths:[String]!, $cwd:String){\n        svnResolve(paths:$paths, cwd:$cwd)\n      }"]);return w=function(){return t},t}function $(){var t=Object(o["a"])(["mutation($paths:[String]!, $cwd:String){\n        svnRevert(paths:$paths, cwd:$cwd)\n      }"]);return $=function(){return t},t}function x(){var t=Object(o["a"])(["mutation($paths:[String]!, $cwd:String, $msg:String!){\n        svnCommit(paths:$paths, cwd:$cwd, msg:$msg)\n      }"]);return x=function(){return t},t}function j(){var t=Object(o["a"])(["mutation($paths:[String]!, $cwd:String){\n        svnAdd(paths:$paths, cwd:$cwd)\n      }"]);return j=function(){return t},t}function O(){var t=Object(o["a"])(["mutation($paths:[String]!, $cwd:String){\n        svnUpdate(paths:$paths, cwd:$cwd)\n      }"]);return O=function(){return t},t}var S=function(t){function e(){var t;return Object(l["a"])(this,e),t=Object(v["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.selected=[],t.pagination={rowsPerPage:10},t.headers=[{text:"路径",value:"path",align:"left"},{text:"状态",value:"type",align:"center"},{text:"版本",value:"revision",align:"center"},{text:"上次提交",value:"path",align:"left"},{text:"操作",value:"path",align:"right"}],t.items=[],t.loading=!1,t.msg="",t}return Object(h["a"])(e,[{key:"created",value:function(){this.fetchData()}},{key:"commitSelected",value:function(){if(!this.selected.length)return this.$toast("请选择提交项");if(!this.msg)return this.$toast("请输入注释");var t=this.selected.map(function(t){return t.path});this.commit(t)}},{key:"addSelected",value:function(){}},{key:"handle",value:function(){var t=Object(c["a"])(s.a.mark(function t(e,n){var a,r;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$apollo.mutate({mutation:n,variables:{paths:e,cwd:this.path,msg:this.msg}});case 2:a=t.sent,r=a.data,this.$emit("message",r[Object.keys(r)[0]]),this.refresh();case 6:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"update",value:function(){return this.handle([],y()(O()))}},{key:"add",value:function(t){return this.handle(t,y()(j()))}},{key:"commit",value:function(t){return this.handle(t,y()(x()))}},{key:"revert",value:function(t){return this.handle(t,y()($()))}},{key:"resolve",value:function(t){return this.handle(t,y()(w()))}},{key:"del",value:function(){var t=Object(c["a"])(s.a.mark(function t(e){return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$confirm("确定要删除吗？");case 2:return t.abrupt("return",this.handle(e,y()(k())));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"fetchData",value:function(){var t=Object(c["a"])(s.a.mark(function t(){var e,n;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,this.$apollo.query({query:y()(_()),variables:{path:this.path}});case 4:e=t.sent,n=e.data.svnStatus,this.items=this.selected=n,t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](1);case 11:this.loading=!1;case 12:case"end":return t.stop()}},t,this,[[1,9]])}));return function(){return t.apply(this,arguments)}}()},{key:"refresh",value:function(){return this.fetchData()}},{key:"has_new",get:function(){return!!this.selected.find(function(t){return"unversioned"===t.type})}}]),Object(u["a"])(e,t),e}(f["d"]);d["a"]([Object(f["c"])(String)],S.prototype,"path",void 0),S=d["a"]([f["a"]],S);var I=S,q=I,M=(n("8f2e"),n("2877")),L=Object(M["a"])(q,m,g,!1,null,null,null);L.options.__file="Local.vue";var C=L.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-text",[n("v-radio-group",{attrs:{row:""},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.radios,function(t,e){return n("v-radio",{key:t,attrs:{label:t,value:e}})}),1),n("v-autocomplete",{attrs:{items:t.structures[t.type],"item-text":"name","item-value":"fullPath",placeholder:"请选择分支"},model:{value:t.selected_item,callback:function(e){t.selected_item=e},expression:"selected_item"}}),n("v-layout",[n("v-spacer"),n("v-btn",{attrs:{small:"",icon:""},on:{click:t.refreshLog}},[n("v-icon",[t._v("refresh")])],1)],1),n("svn-log",{ref:"sl",attrs:{path:t.selected_item,"merge-info":t.mergeInfo},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}}),n("div",{staticStyle:{"margin-top":"-4em"}},[n("v-btn",{attrs:{color:"primary",disabled:0===t.selected.length,loading:t.merging},on:{click:t.merge}},[t._v("合并")])],1)],1)],1)},P=[],E=n("92fa"),F=n.n(E),J=n("3f7a");function R(){var t=Object(o["a"])(["query($path:String!, $page: Int){\n    svnLog(path: $path, page: $page) {\n      page,\n      total,\n      items {\n        revision\n        author\n        date\n        msg\n        paths {\n          kind\n          action\n          path\n        }\n      }\n    }\n  }"]);return R=function(){return t},t}var A=function(t){function e(){var t;return Object(l["a"])(this,e),t=Object(v["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.show=!1,t.files=[],t.items=[],t.pagination={page:1,rowsPerPage:10},t.total=0,t.loading=!1,t.headers=[{text:"版本",value:"revision"},{text:"备注",value:"msg"},{text:"提交者",value:"author"},{text:"提交时间",value:"date"},{text:"查看文件",value:"revision"}],t.query=y()(R()),t}return Object(h["a"])(e,[{key:"showFiles",value:function(t){this.show=!0,this.files=t.map(function(t){var e=t.path,n=t.kind,a=t.action;return{kind:n,action:a,path:e}})}},{key:"onPathChange",value:function(t){this.items=[],this.total=0,1===this.pagination.page?this.fetchData(1):this.pagination.page=1}},{key:"input",value:function(t){}},{key:"refresh",value:function(){return this.fetchData(this.pagination.page)}},{key:"fetchData",value:function(){var t=Object(c["a"])(s.a.mark(function t(e){var n,a,r,i;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.path){t.next=2;break}return t.abrupt("return");case 2:return this.loading=!0,t.next=5,this.$apollo.query({query:this.query,variables:{path:this.path,page:e}});case 5:n=t.sent,a=n.data.svnLog,a.page,r=a.items,i=a.total,this.items=r.map(function(t){return t.msg=t.msg.split(/\r?\n/),t}),this.input([]),this.total=i,this.loading=!1;case 14:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"onPagination",value:function(t){this.pagination=t,this.fetchData(t.page)}},{key:"render",value:function(){var t=this,e=arguments[0],n={props:{"select-all":!!this.mergeInfo&&"primary"},on:{"update:pagination":this.onPagination},scopedSlots:{items:function(n){var a=n.item,r=[e("td",[" ",a.revision," "]),e("td",[a.msg.map(function(t,n){return e("div",{key:n},[" ",t," "])})]),e("td",[a.author," "]),e("td",[f["d"].filter("date")(a.date)," "]),e("td",[e("v-icon",{on:{click:function(){return t.showFiles(a.paths)}}},["filter_tilt_shif t "])])];return t.mergeInfo&&(t.mergeInfo.includes(a.revision)&&(r[0]=e("td",{attrs:{title:"已合并"}},[e("v-badge",{attrs:{color:"purple",left:!0}},[e("v-icon",{slot:"badge",attrs:{dark:!0,small:!0}},["alarm_off"]),a.revision])])),r.unshift(e("td",[e("v-checkbox",{attrs:{"input-value":n.selected,color:"primary"},on:{change:function(t){return n.selected=t}}})]))),r}}};return this.mergeInfo&&(n.props.value=this.value,n.o.input=this.input),e("div",[e("v-data-table",F()([n,{attrs:{items:this.items,headers:this.headers,pagination:this.pagination,loading:this.loading,"total-items":this.total,"item-key":"revision"}}])),e("my-dialog",{on:{input:function(e){return t.show=e}},attrs:{value:this.show,"max-width":"800px"}},[e("v-list",[this.files.map(function(t){return e("v-list-tile",{key:t.path},[e("v-list-tile-action",["dir"===t.kind?e("v-icon",{attrs:{color:"amber"}},["folder"]):e("v-icon",{attrs:{color:"indigo"}},["mdi-file"])]),e("v-list-tile-content",[t.path])])})])])])}}]),Object(u["a"])(e,t),e}(f["d"]);d["a"]([Object(f["c"])(String)],A.prototype,"path",void 0),d["a"]([Object(f["c"])(String)],A.prototype,"remoteBase",void 0),d["a"]([Object(f["c"])()],A.prototype,"mergeInfo",void 0),d["a"]([Object(f["c"])()],A.prototype,"value",void 0),d["a"]([Object(f["e"])("path")],A.prototype,"onPathChange",null),d["a"]([Object(f["b"])()],A.prototype,"input",null),A=d["a"]([Object(f["a"])({components:{MyDialog:J["a"]}})],A);var B,U,z=A,G=z,H=(n("4648"),Object(M["a"])(G,B,U,!1,null,null,null));H.options.__file="Log.vue";var K=H.exports;function N(){var t=Object(o["a"])(["query($path: String!) {\n        svnStructure(path: $path) {\n          name\n          fullPath\n          type\n          commit {\n            author\n            date\n            revision\n          }\n        }\n      }"]);return N=function(){return t},t}function Q(){var t=Object(o["a"])(["query($path: String!,$url: String!) {\n        svnMergeInfo(path: $path, url: $url)\n      }"]);return Q=function(){return t},t}function T(){var t=Object(o["a"])(["mutation($path: String!, $url: String!, $revisions: [Int]!){\n        svnMerge(path: $path, url: $url, revisions: $revisions)\n      }"]);return T=function(){return t},t}var V=function(t){function e(){var t;return Object(l["a"])(this,e),t=Object(v["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.fields=[],t.radios=["branches","tags","trunk"],t.type=0,t.structures=[],t.selected_item="",t.mergeInfo=[],t.selected=[],t.merging=!1,t}return Object(h["a"])(e,[{key:"created",value:function(){this.getStructure()}},{key:"refreshLog",value:function(){var t=this.$refs.sl;t.refresh()}},{key:"merge",value:function(){var t=Object(c["a"])(s.a.mark(function t(){var e,n,a;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this.selected.map(function(t){return t.revision}).sort(function(t,e){return t-e}),this.$emit("message","开始合并"),this.merging=!0,t.prev=3,t.next=6,this.$apollo.mutate({mutation:y()(T()),variables:{path:this.path,url:this.selected_item,revisions:e}});case 6:n=t.sent,a=n.data.svnMerge,this.getMergeInfo(this.selected_item),this.$emit("message",a),this.$emit("merged"),this.$toast("合并成功"),this.selected=[],t.next=17;break;case 15:t.prev=15,t.t0=t["catch"](3);case 17:this.merging=!1;case 18:case"end":return t.stop()}},t,this,[[3,15]])}));return function(){return t.apply(this,arguments)}}()},{key:"getMergeInfo",value:function(){var t=Object(c["a"])(s.a.mark(function t(e){var n,a;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.mergeInfo=[],t.next=3,this.$apollo.query({query:y()(Q()),variables:{path:this.path,url:e}});case 3:n=t.sent,a=n.data.svnMergeInfo,this.mergeInfo=a;case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"getStructure",value:function(){var t=Object(c["a"])(s.a.mark(function t(){var e,n;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$apollo.query({query:y()(N()),variables:{path:this.url}});case 2:e=t.sent,n=e.data.svnStructure,this.structures=n;case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),Object(u["a"])(e,t),e}(f["d"]);d["a"]([Object(f["c"])(String)],V.prototype,"path",void 0),d["a"]([Object(f["c"])(String)],V.prototype,"url",void 0),d["a"]([Object(f["c"])(String)],V.prototype,"root",void 0),d["a"]([Object(f["e"])("selected_item")],V.prototype,"getMergeInfo",null),d["a"]([Object(f["e"])("url")],V.prototype,"getStructure",null),V=d["a"]([Object(f["a"])({components:{SvnLog:K}})],V);var W=V,X=W,Y=(n("ae3c"),Object(M["a"])(X,D,P,!1,null,null,null));Y.options.__file="Merge.vue";var Z=Y.exports;function tt(){var t=Object(o["a"])(["query($path:String!){\n        svnInfo(path:$path) {\n          url,\n          repository {\n            root\n          }\n        }\n      }"]);return tt=function(){return t},t}var et=function(t){function e(){var t;return Object(l["a"])(this,e),t=Object(v["a"])(this,Object(p["a"])(e).apply(this,arguments)),t.tab="tab-1",t.logs=[],t.log_path="",t.log_remote_base="",t.show_log=!1,t.remote_base="",t.url="",t.root="",t}return Object(h["a"])(e,[{key:"created",value:function(){this.getInfo()}},{key:"onMerged",value:function(){var t=this.$refs.sl;t.refresh()}},{key:"showLog",value:function(t){var e,n,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.show_log=!0,"string"===typeof t?(e=t,n=this.remote_base,a&&(e=this.path+"/"+e)):(e=t.path,n=t.remote_base),this.log_path=e,this.log_remote_base=n}},{key:"onMessage",value:function(t){this.logs.unshift({date:new Date,items:t.split(/\r?\n/)})}},{key:"getInfo",value:function(){var t=Object(c["a"])(s.a.mark(function t(){var e,n,a,r;return s.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$apollo.query({query:y()(tt()),variables:{path:this.path}});case 2:e=t.sent,n=e.data.svnInfo,a=n.url,r=n.repository.root,this.url=a,this.root=r,this.remote_base=a.replace(r,"");case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"clearLogs",value:function(){this.logs=[]}},{key:"path",get:function(){return this.$route.params.id}}]),Object(u["a"])(e,t),e}(f["d"]);et=d["a"]([Object(f["a"])({components:{SvnLocal:C,SvnMerge:Z,SvnLog:K,MyDialog:J["a"]}})],et);var nt=et,at=nt,rt=(n("c7e3"),Object(M["a"])(at,a,r,!1,null,null,null));rt.options.__file="_id.vue";e["default"]=rt.exports},ae3c:function(t,e,n){"use strict";var a=n("1921"),r=n.n(a);r.a},c7e3:function(t,e,n){"use strict";var a=n("734d"),r=n.n(a);r.a}}]);