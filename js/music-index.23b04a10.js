(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["music-index"],{"2c53":function(t,e,a){},"2f34":function(t,e,a){"use strict";var r=a("2c53"),i=a.n(r);i.a},3272:function(t,e,a){"use strict";a.d(e,"a",function(){return d}),a.d(e,"b",function(){return h});var r=a("bc3a"),i=a.n(r),n=(a("4758"),a("9530")),s=a.n(n),o=a("53b8");const c={async search(t,e){var a=await i.a.get("https://api.imjad.cn/cloudmusic/",{params:{type:"search",s:t,offset:e}}),r=a.data;if(200!==r.code)throw new Error("加载失败...");var n=r.result.songCount,s=r.result.songs.map(t=>({singer:t.ar[0].name,cover:t.al.picUrl,title:t.al.name,arName:t.name,id:t.id,mv:t.mv}));return{page:e+1,pages:Math.ceil(n/20),items:s}},getUrl(t){return i.a.get(`https://api.imjad.cn/cloudmusic/?type=song&br=128000&id=${t}`).then(({data:{data:[{url:t}]}})=>{if(!t)throw new Error("抱歉，该歌曲不存在");return t})},getLyric(t){return i.a.get(`https://api.imjad.cn/cloudmusic/?type=lyric&br=128000&id=${t}`).then(({data:t})=>{if(200!==t.code)throw new Error(t);if(t.nolyric||!t.lrc)throw new Error("无歌词");return t.lrc.lyric})},getRecoms(){throw new Error("暂无功能")},getHotKey(){throw new Error("暂无功能")},getSmartbox(t){throw new Error("暂无功能")},getMvUrl(t){return i.a.get(`https://api.imjad.cn/cloudmusic/?type=mv&br=128000&id=${t}`).then(({data:{data:t,code:e}})=>{if(200!==e)throw new Error("抱歉，没有找到该mv");return{cover:t.cover,url:t.brs[Object.keys(t.brs)[0]]}})}},l={async search(t,e,a){var r=await o["a"].query({query:s.a`query ($kw: String!,$type:String!, $page:Int) {
        musicSearch(kw:$kw, type:$type,page:$page) {
          page
          pages
          items
        }
      }`,variables:{kw:t,page:e,type:a}}),i=r.data.musicSearch,n=i.page,c=i.pages,l=i.items;return{page:n,pages:c,items:l}},getLyric(t){throw new Error("暂无功能")},getUrl(t){throw new Error("暂无功能")},getRecoms(){throw new Error("暂无功能")},getHotKey(){throw new Error("暂无功能")},getSmartbox(t){throw new Error("暂无功能")},getMvUrl(t){throw new Error("暂无功能")}},u={async search(t,e){var a=await i.a.get("https://api.apiopen.top/searchMusic",{params:{name:t}}),r=a.data,n=r.result.map(t=>Object.assign(t,{artist:t.author,cover:t.pic,type:"",id:t.songid}));return{page:1,pages:1,items:n}},getUrl(t){return i.a.get(`https://api.apiopen.top/musicDetails?id=${t}`).then(({data:{result:{songList:[{songLink:t}]}}})=>{if(!t)throw new Error("抱歉，该歌曲不存在");return t})},async getLyric(t){var e=await i.a.get(`https://api.apiopen.top/musicDetails?id=${t}`).then(({data:{result:{songList:[{lrcLink:t}]}}})=>t),a=await i.a.get(e),r=a.data;return r},getRecoms(){throw new Error("暂无功能")},getHotKey(){throw new Error("暂无功能")},getSmartbox(t){throw new Error("暂无功能")},getMvUrl(t){throw new Error("暂无功能")}},p={wangyiyun:c,qqjt:u};function d(t){return p[t]||l}async function h(t){var e=await i.a.get("https://api.apiopen.top/musicRankings"),a=e.data;return a.result.map(t=>{return t.content=t.content.map(t=>Object.assign(t,{id:t.song_id})),t})}},"7d65":function(t,e,a){},aa6a:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("search-wrap",{attrs:{"default-type":"wangyiyun",types:t.types,"search-handler":t.searchHandler},on:{play:t.toPlay},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.item;return a("div",{staticClass:"grey--text"},[t._v("\n    歌手："+t._s(r.singer)+"\n    "),r.arName?[t._v("\n      专辑："+t._s(r.arName)+"\n    ")]:t._e()],2)}},{key:"actions",fn:function(e){var r=e.item;return r.mv?a("v-btn",{attrs:{color:"blue"},on:{click:function(e){t.toPlayMv(r)}}},[a("v-icon",[t._v("videocam")]),t._v("\n    MV\n  ")],1):t._e()}}])},[a("div",{attrs:{slot:"other"},slot:"other"},t._l(t.recommends,function(e,r){return a("v-card",{key:r},[a("v-card-title",[a("div",{staticClass:"headline orange--text"},[t._v("\n          "+t._s(e.name)+"\n        ")])]),a("v-divider"),a("v-card-text",t._l(e.content,function(e,r){return a("v-card",{key:r,staticClass:"my-1",attrs:{flat:""}},[a("v-layout",[a("div",[a("v-img",{attrs:{src:e.pic_big,"lazy-src":"https://img.imjad.cn/images/2019/02/15/330720-140F40QG761.jpg",width:"200","aspect-ratio":1.3}})],1),a("v-flex",[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("div",{staticClass:"headline"},[t._v(t._s(e.title))]),a("div",{staticClass:"grey--text"},[t._v("\n                    歌手："+t._s(e.author)+"\n                    "),e.album_title?[t._v("\n                      专辑："+t._s(e.album_title)+"\n                    ")]:t._e()],2)])]),a("v-card-actions",[a("v-btn",{attrs:{color:"primary"},on:{click:function(a){t.toPlay(e,"qqjt")}}},[a("v-icon",[t._v("play_circle_filled")])],1)],1)],1)],1)],1)}),1)],1)}),1)])},i=[],n=a("9ab4"),s=a("60a3"),o=a("3272"),c=a("df56");let l=class extends s["d"]{constructor(){super(...arguments),this.types=[],this.recommends=[]}created(){Object(o["b"])(this.type).then(t=>{this.recommends=t}),this.types=[{value:"wangyiyun",text:"网易云音乐"},{value:"qqjt",text:"千千静听"},{value:"qq",text:"QQ音乐"},{value:"kuwo",text:"酷我"},{value:"netease",text:"网易"},{value:"xiami",text:"虾米"},{value:"kugou",text:"酷狗"},{value:"baidu",text:"百度"},{value:"1ting",text:"一听"},{value:"migu",text:"咪咕"},{value:"lizhi",text:"荔枝"},{value:"qingting",text:"蜻蜓"},{value:"ximalaya",text:"喜马拉雅"},{value:"kg",text:"全民K歌"},{value:"5singyc",text:"5sing原创"},{value:"5singfc",text:"5sing翻唱"}]}async searchHandler({type:t,kw:e,page:a}){return Object(o["a"])(t).search(e,a,t)}get type(){return this.$route.query.type}toPlay(t,e=this.type){this.$router.push({name:"music-id",params:{id:t.id},query:{url:t.url,type:e}})}async toPlayMv(t){var e=await Object(o["a"])(this.type).getMvUrl(t.mv);this.$router.push({name:"music-mv",query:e})}};l=n["a"]([Object(s["a"])({components:{SearchWrap:c["a"]}})],l);var u=l,p=u,d=(a("2f34"),a("2877")),h=Object(d["a"])(p,r,i,!1,null,null,null);h.options.__file="index.vue";e["default"]=h.exports},cf5c:function(t,e,a){"use strict";var r=a("7d65"),i=a.n(r);i.a},df56:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{attrs:{fluid:""}},[a("v-layout",[a("div",[a("v-autocomplete",{attrs:{items:t.types,placeholder:"来源"},on:{change:t.onTypeChange},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}})],1),a("v-text-field",{attrs:{placeholder:"请输入关键字","append-icon":"search",loading:t.loading,autofocus:""},on:{"click:append":function(e){t.onSearch(!0)},keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.onSearch(!0)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1),t.loading?a("div",{staticClass:"text-xs-center"},[a("v-progress-circular",{attrs:{size:70,width:7,color:"purple",indeterminate:""}})],1):t.keyword?t.error_text?a("div",{staticClass:"text-xs-center grey--text"},[t._v("\n    "+t._s(t.error_text)+"\n    "),a("v-btn",{attrs:{small:"",color:"error",flat:""},on:{click:t.search}},[t._v("重试")])],1):a("div",[a("v-layout",[a("v-flex",[t._v("\n        搜索结果 "+t._s(0===t.contents.length?"无":"")+"\n      ")]),a("v-btn",{attrs:{icon:"",title:"刷新"},on:{click:t.search}},[a("v-icon",[t._v("refresh")])],1)],1),a("v-layout",{attrs:{wrap:""}},[a("v-slide-y-transition",{staticStyle:{display:"block",width:"100%"},attrs:{group:""}},t._l(t.contents,function(e,r){return a("v-flex",{key:r,staticClass:"my-1",attrs:{xs12:""}},[a("v-card",{attrs:{flat:""}},[a("v-layout",[a("div",[a("v-img",{attrs:{src:e.cover,"lazy-src":"https://img.imjad.cn/images/2019/02/15/330720-140F40QG761.jpg",width:"200","aspect-ratio":1.3}},[e.type?a("span",{staticClass:"blue white--text px-1"},[t._v("\n                    "+t._s(e.type)+"\n                  ")]):t._e()])],1),a("v-flex",[a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("div",{staticClass:"headline"},[t._v(t._s(e.title))]),t._t("default",null,{item:e})],2)]),a("v-card-actions",[a("v-btn",{attrs:{color:"primary"},on:{click:function(a){t.play(e)}}},[a("v-icon",[t._v("play_circle_filled")])],1),t._t("actions",null,{item:e})],2)],1)],1)],1)],1)}),1)],1),a("div",{staticClass:"text-xs-center"},[t.total_page>0?a("v-pagination",{attrs:{length:t.total_page},on:{input:function(e){t.onSearch(!1)}},model:{value:t.offset,callback:function(e){t.offset=e},expression:"offset"}}):t.total_page<0?a("div",[a("v-btn",{attrs:{disabled:t.offset<=1},on:{click:function(e){t.toPage(t.offset-1)}}},[t._v("上一页")]),a("v-btn",{on:{click:function(e){t.toPage(t.offset+1)}}},[t._v("下一页")])],1):t._e()],1)],1):t._t("other")],2)},i=[],n=a("9ab4"),s=a("60a3");let o=class extends s["d"]{constructor(){super(...arguments),this.contents=[],this.keyword="",this.type="",this.offset=1,this.limit=20,this.loading=!1,this.total_page=0,this.error_text=""}beforeRouteUpdate(){this.syncParams(),this.keyword&&this.search()}syncParams(){let t=this.$route.query;this.keyword=t.keyword,this.limit=Number(t.limit)||20,this.offset=Number(t.offset)||1,this.type=t.type||this.defaultType}onTypeChange(){this.keyword&&this.onSearch(!0)}onSearch(t){t&&(this.offset=1),this.$router.push({name:this.$route.name,query:{keyword:this.keyword,offset:String(this.offset),limit:String(this.limit),type:this.type}})}async search(){this.loading=!0,this.contents=[];try{var t=await this.searchHandler({kw:this.keyword,page:this.offset-1,type:this.type}),e=t.pages,a=t.items;this.total_page=e,this.contents=a.map(t=>{return t.collapsed=!0,t}),this.error_text=""}catch(t){this.error_text=t.message}this.loading=!1}play(t){}toPage(t){this.offset=t,this.onSearch(!1)}};n["a"]([Object(s["c"])()],o.prototype,"types",void 0),n["a"]([Object(s["c"])(Function)],o.prototype,"searchHandler",void 0),n["a"]([Object(s["c"])()],o.prototype,"defaultType",void 0),n["a"]([Object(s["e"])("$route",{immediate:!0})],o.prototype,"beforeRouteUpdate",null),n["a"]([Object(s["b"])()],o.prototype,"play",null),o=n["a"]([Object(s["a"])({})],o);var c=o,l=c,u=(a("cf5c"),a("2877")),p=Object(u["a"])(l,r,i,!1,null,null,null);p.options.__file="SearchWrap.vue";e["a"]=p.exports}}]);