(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["special-id"],{"4bc2":function(e,t,a){"use strict";var n=a("6701"),i=a.n(n);i.a},6701:function(e,t,a){},"8a5c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ApolloQuery",{staticClass:"pa-2",staticStyle:{display:"flex","flex-direction":"column",height:"100%"},attrs:{query:a("9834"),fetchPolicy:"no-cache",variables:{id:e.$route.params.id}},on:{result:e.onResult},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.isLoading,i=t.result.data;return!a&&i?[n("div",{staticClass:"headline"},[e._v(e._s(e.title)+"\n      "),e.loading?n("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}):n("v-btn",{attrs:{color:"primary"},on:{click:e.produceHtml}},[e._v("获取代码")])],1),n("json-editor",{ref:"editor",staticStyle:{flex:"1"},attrs:{schema:e.schema,layout:e.layout,value:e.defdata},on:{submit:e.submit,loaded:function(t){e.loading=!1}}}),e.show_dialog?n("x-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:e.show_dialog,callback:function(t){e.show_dialog=t},expression:"show_dialog"}},[n("v-textarea",{attrs:{autofocus:""},model:{value:e.result_code,callback:function(t){e.result_code=t},expression:"result_code"}}),n("v-layout",[n("v-spacer"),n("v-btn",{on:{click:function(t){e.show_dialog=!1}}},[e._v("关闭")])],1)],1):e._e()]:void 0}}])})},i=[],r=a("6eec"),s=a("9393"),c=a("a34a"),o=a.n(c),u=a("3040"),l=a("c665"),d=a("dc0a"),m=a("aa9a"),p=a("d328"),v=a("11d9"),f=a("9ab4"),h=a("60a3"),b=a("b17e"),y=a("9530"),k=a.n(y),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("iframe",{ref:"ifr",staticStyle:{width:"100%"},attrs:{src:e.url,frameborder:"0"},on:{load:e.onFrameLoad}})},g=[],O=a("8afe"),_=function(e){function t(e){var a;return Object(l["a"])(this,t),a=Object(p["a"])(this,Object(v["a"])(t).call(this,e)),a.url="/ody-json-schema/index.html",a.promise_data=new Promise(function(e){a.promise_resolve=e}),a}return Object(m["a"])(t,[{key:"onSchemaChange",value:function(e){e&&this.promise_resolve()}},{key:"handler",value:function(e){var t=e.data.formData;t&&this.$emit("submit",t)}},{key:"onFrameLoad",value:function(){var e=Object(u["a"])(o.a.mark(function e(){var t,a,n;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.promise_data;case 2:this.$emit("loaded"),t=this.$refs.if,a=t.contentWindow,n=this.layout,n=this.layout?Object(O["a"])(n).concat([{type:"submit",title:"保存"}]):["*",{type:"submit",title:"保存"}],a.postMessage({schema:this.schema,layout:n,data:this.value},"*");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"created",value:function(){window.addEventListener("message",this.handler)}},{key:"beforeDestroy",value:function(){window.removeEventListener("message",this.handler)}}]),Object(d["a"])(t,e),t}(h["d"]);f["a"]([Object(h["c"])()],_.prototype,"schema",void 0),f["a"]([Object(h["c"])()],_.prototype,"layout",void 0),f["a"]([Object(h["c"])()],_.prototype,"value",void 0),f["a"]([Object(h["e"])("schema",{immediate:!0})],_.prototype,"onSchemaChange",null),_=f["a"]([Object(h["a"])({})],_);var j=_,x=j,S=(a("4bc2"),a("2877")),N=Object(S["a"])(x,w,g,!1,null,null,null);N.options.__file="JsonEditor.vue";var $=N.exports;function F(){var e=Object(r["a"])(["mutation($item:SpecialInput!){\n        editSpecial(item:$item)\n      }"]);return F=function(){return e},e}var D=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(p["a"])(this,Object(v["a"])(t).apply(this,arguments)),e.title="",e.schema=null,e.defdata=null,e.layout=null,e.template="",e.styles="",e.scripts="",e.result_code="",e.show_dialog=!1,e.loading=!0,e}return Object(m["a"])(t,[{key:"getVue",value:function(){return a.e("chunk-2d229a34").then(a.bind(null,"ddfd")).then(function(e){return e.default})}},{key:"onResult",value:function(e){var t=this,a=e.loading,n=e.data;if(!a){var i=n.special;this.title=i.name,this.template=i.template,this.scripts=i.scripts,this.styles=i.styles;var r=[];r.push(Object(u["a"])(o.a.mark(function e(){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",JSON.parse(i.schema));case 4:return e.prev=4,e.t0=e["catch"](0),e.abrupt("return",t.$axios.get(i.schema).then(function(e){var t=e.data;return t}));case 7:case"end":return e.stop()}},e,this,[[0,4]])}))()),r.push(Object(u["a"])(o.a.mark(function e(){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!i.layout){e.next=8;break}return e.prev=1,e.abrupt("return",JSON.parse(i.layout));case 5:return e.prev=5,e.t0=e["catch"](1),e.abrupt("return",t.$axios.get(i.layout).then(function(e){var t=e.data;return t}));case 8:case"end":return e.stop()}},e,this,[[1,5]])}))()),r.push(Object(u["a"])(o.a.mark(function e(){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!i.data){e.next=8;break}return e.prev=1,e.abrupt("return",JSON.parse(i.data));case 5:return e.prev=5,e.t0=e["catch"](1),e.abrupt("return",t.$axios.get(i.data).then(function(e){var t=e.data;return t}));case 8:case"end":return e.stop()}},e,this,[[1,5]])}))()),Promise.all(r).then(function(e){var a=Object(s["a"])(e,3),n=a[0],i=a[1],r=a[2];t.schema=n,t.layout=i,t.defdata=r})}}},{key:"produceHtml",value:function(){var e=Object(u["a"])(o.a.mark(function e(){var t,a,n=this;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getVue();case 2:t=e.sent,a=new t({template:"<div>".concat(this.template,"</div>"),data:Object(b["b"])(this.defdata),mounted:function(){var e=a.$el.innerHTML;n.styles&&(e="<style>".concat(n.styles,"</style>")+e),n.scripts&&(e+="<script>".concat(n.scripts,"</")+"script>"),n.result_code=e,n.show_dialog=!0}}),a.$mount();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"submit",value:function(){var e=Object(u["a"])(o.a.mark(function e(t){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.defdata=t,this.$apollo.mutate({mutation:k()(F()),variables:{item:{id:this.$route.params.id,data:JSON.stringify(t,null,2)}}}),this.template&&this.produceHtml();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),Object(d["a"])(t,e),t}(h["d"]);D=f["a"]([Object(h["a"])({components:{JsonEditor:$}})],D);var E=D,J=E,L=(a("bffa"),Object(S["a"])(J,n,i,!1,null,null,null));L.options.__file="_id.vue";t["default"]=L.exports},9834:function(e,t){var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"special"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"template"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schema"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"layout"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"styles"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"scripts"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:137}};a.loc.source={body:"query($id: ID!){\r\n  special(id: $id) {\r\n    id\r\n    name\r\n    template\r\n    schema\r\n    data\r\n    layout\r\n    styles\r\n    scripts\r\n  }\r\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var a=e.type;"NamedType"===a.kind&&t.add(a.name.value)}e.selectionSet&&e.selectionSet.selections.forEach(function(e){n(e,t)}),e.variableDefinitions&&e.variableDefinitions.forEach(function(e){n(e,t)}),e.definitions&&e.definitions.forEach(function(e){n(e,t)})}var i={};(function(){a.definitions.forEach(function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})})(),e.exports=a},"9e10":function(e,t,a){},bffa:function(e,t,a){"use strict";var n=a("9e10"),i=a.n(n);i.a}}]);